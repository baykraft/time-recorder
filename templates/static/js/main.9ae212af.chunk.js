(this["webpackJsonptime-recorder-view"]=this["webpackJsonptime-recorder-view"]||[]).push([[0],{100:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(18),i=a.n(r),o=(a(64),a(22)),s=a(16),l=a(19),u=a(113),m=a(118),h=a(119),d=a(115),f=a(117),g=a(116),p=a(24),k=a.n(p),E=a(41),v=a.n(E),b=a(42),w=a(20),j=a(43),O=a(44),y=a(48),_=new(function(e){function t(){var e;return Object(b.a)(this,t),(e=Object(j.a)(this,Object(O.a)(t).call(this))).authenticated=!1,e.accessToken="",e.user={},e}return Object(y.a)(t,e),Object(w.a)(t,[{key:"isAuthenticated",value:function(){return this.authenticated}},{key:"setAuthenticated",value:function(e){this.authenticated=e,this.emit("change")}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"setAccessToken",value:function(e){this.accessToken=e,this.emit("change")}},{key:"getUser",value:function(){return this.user}},{key:"setUser",value:function(e){this.user=e,this.emit("change")}}]),t}(a(45).EventEmitter)),A=a(46),N=a.n(A),x=a(27),T=a.n(x),B=Object(u.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},slack:{width:32,height:32,marginRight:e.spacing(2)}}}));var R=function(){var e=B(),t=Object(n.useState)(!1),a=Object(l.a)(t,2),r=a[0],i=a[1];return Object(n.useEffect)((function(){_.on("change",(function(){i(_.isAuthenticated())}));var e=N.a.parse(window.location.search).code;void 0!==e&&T.a.get("https://slack.com/api/oauth.access",{params:{client_id:"3246745826.923685300119",client_secret:"0f959af4f1b0e43cd06a021d5390e188",code:e,redirect_uri:"https://baykraft-time-recorder.herokuapp.com/"}}).then((function(e){if(e.data.ok){var t=e.data.access_token,a=e.data.user_id;T.a.get("https://slack.com/api/users.info",{params:{token:t,user:a}}).then((function(e){e.data.ok&&(_.setUser(e.data.user),_.setAccessToken(t),_.setAuthenticated(!0))}))}}))}),[]),r?c.a.createElement(s.a,{to:"/timesheet"}):c.a.createElement("div",{className:e.root},c.a.createElement(h.a,{position:"static"},c.a.createElement(d.a,null,c.a.createElement(g.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},c.a.createElement(k.a,null)),c.a.createElement(f.a,{variant:"h6",className:e.title},"\u682a\u5f0f\u4f1a\u793e\u30d9\u30a4\u30af\u30e9\u30d5\u30c8"),c.a.createElement(m.a,{color:"inherit",onClick:function(){window.location="https://slack.com/oauth/authorize?client_id=".concat("3246745826.923685300119","&scope=users:read&redirect_uri=").concat("https://baykraft-time-recorder.herokuapp.com/")}},c.a.createElement("img",{src:v.a,className:e.slack,alt:"slack"}),"Login with Slack"))))},S=a(2);function G(e){var t=e.children,a=Object(S.a)(e,["children"]),r=Object(n.useState)(_.isAuthenticated()),i=Object(l.a)(r,1)[0];return c.a.createElement(s.b,Object.assign({},a,{render:function(e){var a=e.location;return i?t:c.a.createElement(s.a,{to:{pathname:"/",state:{from:a}}})}}))}var U=Object(u.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},userIcon:{borderRadius:5,marginRight:e.spacing(2)}}}));function I(){var e=U(),t=Object(n.useState)(_.getUser()),a=Object(l.a)(t,1)[0];return c.a.createElement("div",{className:e.root},c.a.createElement(h.a,{position:"static"},c.a.createElement(d.a,null,c.a.createElement(g.a,{edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu"},c.a.createElement(k.a,null)),c.a.createElement(f.a,{variant:"h6",className:e.title},"\u682a\u5f0f\u4f1a\u793e\u30d9\u30a4\u30af\u30e9\u30d5\u30c8"),c.a.createElement(m.a,{color:"inherit"},c.a.createElement("img",{src:a.profile.image_32,className:e.userIcon,alt:"icon"}),a.profile.real_name))),c.a.createElement("h1",null,"TimeSheet"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement((function(){return c.a.createElement(o.a,null,c.a.createElement(s.d,null,c.a.createElement(s.b,{exact:!0,path:"/"},c.a.createElement(R,null)),c.a.createElement(G,{path:"/timesheet"},c.a.createElement(I,null))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},41:function(e,t,a){e.exports=a.p+"static/media/slack_icon.be396144.svg"},59:function(e,t,a){e.exports=a(100)},64:function(e,t,a){}},[[59,1,2]]]);
//# sourceMappingURL=main.9ae212af.chunk.js.map